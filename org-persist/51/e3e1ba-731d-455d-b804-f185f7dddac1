(((elisp org-element--headline-cache) . #s(avl-tree- [[[[nil nil #3=(headline (:raw-value #1="Recorrentes" :begin 22 :end 3482 :pre-blank 0 :contents-begin 100 :contents-end 3481 :robust-begin 102 :robust-end 3479 :level 1 :priority nil :tags ("recorrentes") :todo-keyword nil :todo-type nil :post-blank 1 :footnote-section-p nil :archivedp nil :commentedp nil :post-affiliated 22 :title #1# :mode nil :granularity element :cached t :parent #7=(org-data (:begin 1 :contents-begin 1 :contents-end 8552 :end 8552 :robust-begin 3 :robust-end 8550 :post-blank 0 :post-affiliated 1 :path "/Users/macpc/Projects/org-files/agenda/financeiro.org" :mode org-data :CATEGORY "financeiro" :cached t :org-element--cache-sync-key nil)) :org-element--cache-sync-key nil)) 0] [nil nil #13=(headline (:raw-value #2="Pagar Mãe 1: -1000.00" :begin 1640 :end 2253 :pre-blank 0 :contents-begin 1670 :contents-end 2253 :robust-begin 1756 :robust-end 2251 :level 2 :priority nil :tags nil :todo-keyword #("TODO" 0 4 (isearch-open-invisible-temporary org-fold-core--isearch-show-temporary isearch-open-invisible org-fold-core--isearch-show org-fold--spec-org-fold-outline--333385810937194518 org-fold-outline)) :todo-type todo :post-blank 0 :footnote-section-p nil :archivedp nil :commentedp nil :post-affiliated 1640 :deadline (timestamp (:type active :raw-value "<2023-06-01 qui +1m>" :year-start 2023 :month-start 6 :day-start 1 :hour-start nil :minute-start nil :year-end 2023 :month-end 6 :day-end 1 :hour-end nil :minute-end nil :begin 1680 :end 1700 :post-blank 0 :repeater-type cumulate :repeater-value 1 :repeater-unit month)) :LAST_REPEAT "[2023-05-03 qua 00:55]" :title #2# :mode nil :granularity element :cached t :parent #3# :org-element--cache-sync-key nil)) 0] #11=(headline (:raw-value #4="Fazer BookKeeping" :begin 100 :end 1640 :pre-blank 0 :contents-begin 126 :contents-end 1640 :robust-begin 213 :robust-end 1638 :level 2 :priority nil :tags nil :todo-keyword #("TODO" 0 4 (isearch-open-invisible-temporary org-fold-core--isearch-show-temporary isearch-open-invisible org-fold-core--isearch-show org-fold--spec-org-fold-outline--333385810937194518 org-fold-outline)) :todo-type todo :post-blank 0 :footnote-section-p nil :archivedp nil :commentedp nil :post-affiliated 100 :deadline (timestamp (:type active :raw-value "<2023-05-21 dom ++1w>" :year-start 2023 :month-start 5 :day-start 21 :hour-start nil :minute-start nil :year-end 2023 :month-end 5 :day-end 21 :hour-end nil :minute-end nil :begin 136 :end 157 :post-blank 0 :repeater-type catch-up :repeater-value 1 :repeater-unit week)) :LAST_REPEAT "[2023-05-15 seg 01:35]" :title #4# :mode section :granularity element :cached t :parent #3# :org-element--cache-sync-key nil)) 0] [[nil nil #17=(headline (:raw-value #5="Pagar Nickolas: -500.00" :begin 2866 :end 3482 :pre-blank 0 :contents-begin 2898 :contents-end 3481 :robust-begin 2984 :robust-end 3479 :level 2 :priority nil :tags nil :todo-keyword #("TODO" 0 4 (isearch-open-invisible-temporary org-fold-core--isearch-show-temporary isearch-open-invisible org-fold-core--isearch-show org-fold--spec-org-fold-outline--333385810937194518 org-fold-outline)) :todo-type todo :post-blank 1 :footnote-section-p nil :archivedp nil :commentedp nil :post-affiliated 2866 :deadline (timestamp (:type active :raw-value "<2023-05-27 sáb +1m>" :year-start 2023 :month-start 5 :day-start 27 :hour-start nil :minute-start nil :year-end 2023 :month-end 5 :day-end 27 :hour-end nil :minute-end nil :begin 2908 :end 2928 :post-blank 0 :repeater-type cumulate :repeater-value 1 :repeater-unit month)) :LAST_REPEAT "[2023-05-03 qua 00:54]" :title #5# :mode nil :granularity element :cached t :parent #3# :org-element--cache-sync-key nil)) 0] [nil [nil nil #20=(headline #6=(:raw-value "Relatorios faturas" :begin 4971 :end 6288 :pre-blank 0 :contents-begin 4992 :contents-end 6287 :robust-begin 4994 :robust-end 6285 :level 1 :priority nil :tags nil :todo-keyword nil :todo-type nil :post-blank 1 :footnote-section-p nil :archivedp nil :commentedp nil :post-affiliated 4971 :title (#("Relatorios faturas" 0 18 (:parent (headline #6#)))) :parent #7# :cached t :org-element--cache-sync-key nil)) 0] #21=(headline (:raw-value #8="Faturas Finlandia" :begin 4103 :end 4971 :pre-blank 0 :contents-begin 4123 :contents-end 4971 :robust-begin 4125 :robust-end 4969 :level 1 :priority nil :tags nil :todo-keyword nil :todo-type nil :post-blank 0 :footnote-section-p nil :archivedp nil :commentedp nil :post-affiliated 4103 :title #8# :mode nil :granularity element :cached t :parent #7# :org-element--cache-sync-key nil)) 1] #19=(headline (:raw-value #9="Faturas Brasil" :begin 3482 :end 4103 :pre-blank 0 :contents-begin 3499 :contents-end 4101 :robust-begin 3501 :robust-end 4099 :level 1 :priority nil :tags nil :todo-keyword nil :todo-type nil :post-blank 2 :footnote-section-p nil :archivedp nil :commentedp nil :post-affiliated 3482 :title #9# :mode nil :granularity element :org-element--cache-sync-key nil :cached t :parent #7#)) 1] #15=(headline (:raw-value #10="Pagar Mãe 2: -1000.00" :begin 2253 :end 2866 :pre-blank 0 :contents-begin 2283 :contents-end 2866 :robust-begin 2369 :robust-end 2864 :level 2 :priority nil :tags nil :todo-keyword #("TODO" 0 4 (isearch-open-invisible-temporary org-fold-core--isearch-show-temporary isearch-open-invisible org-fold-core--isearch-show org-fold--spec-org-fold-outline--333385810937194518 org-fold-outline)) :todo-type todo :post-blank 0 :footnote-section-p nil :archivedp nil :commentedp nil :post-affiliated 2253 :deadline (timestamp (:type active :raw-value "<2023-06-15 qui +1m>" :year-start 2023 :month-start 6 :day-start 15 :hour-start nil :minute-start nil :year-end 2023 :month-end 6 :day-end 15 :hour-end nil :minute-end nil :begin 2293 :end 2313 :post-blank 0 :repeater-type cumulate :repeater-value 1 :repeater-unit month)) :LAST_REPEAT "[2023-05-15 seg 01:48]" :title #10# :mode nil :granularity element :cached t :parent #3# :org-element--cache-sync-key nil)) 1] nil nil 0] org-element--cache-compare)) ((elisp org-element--cache) . #s(avl-tree- [[[[[[nil nil #7# 0] [nil nil #3# 0] (section (:begin 1 :end 22 :contents-begin 1 :contents-end 21 :robust-begin 1 :robust-end 19 :post-blank 1 :post-affiliated 1 :mode first-section :granularity element :cached t :parent #7# :org-element--cache-sync-key nil)) 0] [[nil nil #12=(section (:begin 126 :end 1640 :contents-begin 126 :contents-end 1640 :robust-begin 126 :robust-end 1638 :post-blank 0 :post-affiliated 126 :mode section :granularity element :cached t :parent #11# :org-element--cache-sync-key nil)) 0] [nil nil (property-drawer (:begin 158 :end 214 :contents-begin 171 :contents-end 208 :post-blank 0 :post-affiliated 158 :mode property-drawer :granularity element :cached t :parent #12# :org-element--cache-sync-key nil)) 0] (planning (:closed nil :deadline (timestamp (:type active :raw-value "<2023-05-21 dom ++1w>" :year-start 2023 :month-start 5 :day-start 21 :hour-start nil :minute-start nil :year-end 2023 :month-end 5 :day-end 21 :hour-end nil :minute-end nil :begin 136 :end 157 :post-blank 0 :repeater-type catch-up :repeater-value 1 :repeater-unit week)) :scheduled nil :begin 126 :end 158 :post-blank 0 :post-affiliated 126 :mode planning :granularity element :cached t :parent #12# :org-element--cache-sync-key nil)) 0] #11# 0] [[[nil nil #14=(section (:begin 1670 :end 2253 :contents-begin 1670 :contents-end 2253 :robust-begin 1670 :robust-end 2251 :post-blank 0 :post-affiliated 1670 :mode section :granularity element :cached t :parent #13# :org-element--cache-sync-key nil)) 0] [nil nil (property-drawer (:begin 1701 :end 1757 :contents-begin 1714 :contents-end 1751 :post-blank 0 :post-affiliated 1701 :mode property-drawer :granularity element :cached t :parent #14# :org-element--cache-sync-key nil)) 0] (planning (:closed nil :deadline (timestamp (:type active :raw-value "<2023-06-01 qui +1m>" :year-start 2023 :month-start 6 :day-start 1 :hour-start nil :minute-start nil :year-end 2023 :month-end 6 :day-end 1 :hour-end nil :minute-end nil :begin 1680 :end 1700 :post-blank 0 :repeater-type cumulate :repeater-value 1 :repeater-unit month)) :scheduled nil :begin 1670 :end 1701 :post-blank 0 :post-affiliated 1670 :mode planning :granularity element :cached t :parent #14# :org-element--cache-sync-key nil)) 0] [[nil nil #16=(section (:begin 2283 :end 2866 :contents-begin 2283 :contents-end 2866 :robust-begin 2283 :robust-end 2864 :post-blank 0 :post-affiliated 2283 :mode section :granularity element :cached t :parent #15# :org-element--cache-sync-key nil)) 0] [nil nil (property-drawer (:begin 2314 :end 2370 :contents-begin 2327 :contents-end 2364 :post-blank 0 :post-affiliated 2314 :mode property-drawer :granularity element :cached t :parent #16# :org-element--cache-sync-key nil)) 0] (planning (:closed nil :deadline (timestamp (:type active :raw-value "<2023-06-15 qui +1m>" :year-start 2023 :month-start 6 :day-start 15 :hour-start nil :minute-start nil :year-end 2023 :month-end 6 :day-end 15 :hour-end nil :minute-end nil :begin 2293 :end 2313 :post-blank 0 :repeater-type cumulate :repeater-value 1 :repeater-unit month)) :scheduled nil :begin 2283 :end 2314 :post-blank 0 :post-affiliated 2283 :mode planning :granularity element :cached t :parent #16# :org-element--cache-sync-key nil)) 0] #15# 0] #13# 0] [[[nil nil #18=(section (:begin 2898 :end 3482 :contents-begin 2898 :contents-end 3481 :robust-begin 2898 :robust-end 3479 :post-blank 1 :post-affiliated 2898 :mode section :granularity element :cached t :parent #17# :org-element--cache-sync-key nil)) 0] nil (planning (:closed nil :deadline (timestamp (:type active :raw-value "<2023-05-27 sáb +1m>" :year-start 2023 :month-start 5 :day-start 27 :hour-start nil :minute-start nil :year-end 2023 :month-end 5 :day-end 27 :hour-end nil :minute-end nil :begin 2908 :end 2928 :post-blank 0 :repeater-type cumulate :repeater-value 1 :repeater-unit month)) :scheduled nil :begin 2898 :end 2929 :post-blank 0 :post-affiliated 2898 :mode planning :granularity element :cached t :parent #18# :org-element--cache-sync-key nil)) -1] [[[nil nil #19# 0] [nil nil #20# 0] #21# 0] [nil [nil nil (table (:begin 6067 :end 6288 :type org :tblfm nil :contents-begin 6092 :contents-end 6287 :value nil :post-blank 1 :post-affiliated 6092 :results ("create_report") :mode nil :granularity element :cached t :parent #22=(section (:begin 4992 :end 6288 :contents-begin 4992 :contents-end 6287 :robust-begin 4992 :robust-end 6285 :post-blank 1 :post-affiliated 4992 :mode section :granularity element :cached t :parent #20# :org-element--cache-sync-key nil)) :org-element--cache-sync-key nil)) 0] (src-block (:language "python" :switches nil :parameters ":var f=(buffer-file-name) :results replace table" :begin 4992 :end 6067 :number-lines nil :preserve-indent nil :retain-labels t :use-labels t :label-fmt nil :value "\11from orgparse import load, loads\12\12\11root = load(f)\12\11faturas_finlandia = root.children[2]\12\12\11tags = []\12\12\11# Populate tags\12\11for child in faturas_finlandia.children:\12\11\11cells = child.body.split('|')[1:-1]\12\11\11cells = [x for x in cells if not '\\n' in x]\12\12\11\11for l in range(len(cells)//5):\12\11\11\11line = cells[l*5:l*5 + 5]\12\11\11\11tag = line[3]\12\11\11\11if not tag in tags:\12\11\11\11\11tags.append(tag)\12\12\11tags.sort()\12\12\11all = [['Dates'] + tags + ['Total']]\12\12\11for child in faturas_finlandia.children:\12\11\11cells = child.body.split('|')[1:-1]\12\11\11cells = [x for x in cells if not '\\n' in x]\12\11\11value_by_tag = {}\12\12\11\11for l in range(len(cells)//5):\12\11\11\11line = cells[l*5:l*5 + 5]\12\11\11\11value = line[2]\12\11\11\11tag = line[3]\12\11\11\11if not tag in value_by_tag:\12\11\11\11\11value_by_tag[tag] = 0.0\12\11\11\11value_by_tag[tag] += float(value)\12\12\11\11total = format(sum(value_by_tag.values()), '.2f')\12\11\11line_tags = [format(value_by_tag[t],'.2f') if t in value_by_tag else \"0.0\" for t in tags]\12\12\11\11all.append([child.heading] + line_tags + [total])\12\12\11return all\12" :post-blank 0 :post-affiliated 5014 :name "create_report" :mode planning :granularity element :cached t :parent #22# :org-element--cache-sync-key nil)) 1] #22# 0] (property-drawer (:begin 2929 :end 2985 :contents-begin 2942 :contents-end 2979 :post-blank 0 :post-affiliated 2929 :mode property-drawer :granularity element :cached t :parent #18# :org-element--cache-sync-key nil)) 1] #17# 0] nil nil 0] org-element--cache-compare)))